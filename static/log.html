<!DOCTYPE html>
<html lang="ja">
  <head>
    <title>log</title>
    <meta charset="utf-8">
    <link rel="icon" href="favicon.ico">
    <link rel="stylesheet" type="text/css" href="./hoge.css">
    <link href="https://fonts.googleapis.com/css?family=M+PLUS+Rounded+1c" rel="stylesheet">
    <link href="https://fonts.googleapis.com/earlyaccess/nicomoji.css" rel="stylesheet">
    <script src="./js/libraries.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/parameter.js" type="text/javascript" charset="utf-8"></script>
    <script src="./js/profile.js" type="module" charset="utf-8"></script>
  </head>
  <body>
    <header>
      <ul class="menu-list">
        <li class="menu-list-item" id="home" onclick="move('index','name')">ãƒ›ãƒ¼ãƒ </li>
        <li class="menu-list-item" id="friend" onclick="move('friend','name')">ãƒ•ãƒ¬ãƒ³ãƒ‰</li>
        <li class="menu-list-item" id="rank" onclick="move('ranking','name')">ãƒ©ãƒ³ã‚­ãƒ³ã‚°</li>
        <li class="menu-list-item" id="mission" onclick="move('mission','name')">ãƒŸãƒƒã‚·ãƒ§ãƒ³</li>
        <li class="menu-list-check" id="log" onclick="move('log','name')">å®Ÿç¸¾</li>
        <li class="menu-list-item" id="setup" onclick="OpenProfile('log')">è¨­å®š</li>
      </ul>
    </header>
    <h1 id="appname">ãã‚“ã¨ã‚Œãƒ­ã‚°</h1>
    <table border="1" align="center">
      <tr>
        <th class="dow" style="color:#F0703E">æ—¥</th>
        <th class="dow">æœˆ</th>
        <th class="dow">ç«</th>
        <th class="dow">æ°´</th>
        <th class="dow">æœ¨</th>
        <th class="dow">é‡‘</th>
        <th class="dow" style="color:#6360FD">åœŸ</th>
      </tr>
      <tr>
        <td class="dowl" id="sun">ã€€</td>
        <td class="dowl" id="mon">ã€€</td>
        <td class="dowl" id="tue">ã€€</td>
        <td class="dowl" id="wed">ã€€</td>
        <td class="dowl" id="thu">ã€€</td>
        <td class="dowl" id="fri">ã€€</td>
        <td class="dowl" id="sat">ã€€</td>
      </tr>
    </table>
    <h1 id="trophytag">ãƒˆãƒ­ãƒ•ã‚£ãƒ¼</h1>
    <table align="center">
      <tr>
        <th class="trophy" id="fir">ã€€</th>
        <th class="trophy" id="huk">ã€€</th>
        <th class="trophy" id="hai">ã€€</th>
        <th class="trophy" id="ude">ã€€</th>
      </tr>
    </table>
    <!-- <script src="./js/tippy.min.js"></script> -->
    <script type="module">
      import { fetchJSON } from "https://code4sabae.github.io/js/fetchJSON.js";
      window.onload = async () => {
        if (param["name"]){
          setup.innerHTML = param["name"];
        }
        //nameã®äººã®logã‚’è¿”ã™
        const req = { id: param["name"] };
        const res1 = await fetchJSON("/api/getlog", req);
        for(let key in res1){
          if(res1[key]){
            document.getElementById(key).innerHTML="ğŸ’ª";
          }
        }
        const res2 = await fetchJSON("/api/getmedal", req);
        //ãƒ¡ãƒ€ãƒ«ã®å½¢å¼å¤‰æ›(json->id)
        const mus = {
          huk: "è…¹ç­‹",
          hai: "èƒŒç­‹",
          ude: "è…•ç«‹ã¦"
        };
        for(let key in res2){
          if (key==="fir"){
            if(res2["fir"]!=0){
              document.getElementById("fir").innerHTML="ğŸ†";
              const text = res2["fir"] + "<br>ã¯ã˜ã‚ã¦ã®ç­‹ãƒˆãƒ¬";
              tippy('#'+key, {
                content: text,
                placement: 'bottom',
                allowHTML: true,
              });
            }
          }else{
            let medal = "ã€€";
            let comment = "ã€€";
            if(res2[key]>=100){
              medal="ğŸ†";
            }else if(res2[key]>=70){
              medal="ğŸ–";
            }else if(res2[key]>=50){
              medal="ğŸ¥‡";
            }else if(res2[key]>=30){
              medal="ğŸ¥ˆ";
            }else if(res2[key]>=5){
              medal="ğŸ¥‰";
            }else{
              continue;
            }
            document.getElementById(key).innerHTML=medal;
            comment = mus[key] + "ã‚’ç´¯è¨ˆ" + res2[key] + "å›é”æˆï¼";
            tippy('#'+key, {
                content: comment,
                placement: 'bottom',
                allowHTML: true,
            });
          }
        }
      }
    </script>
  </body>
</html>
